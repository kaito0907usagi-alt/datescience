\documentclass{jsarticle}

\usepackage[dvipdfmx]{graphicx}
\usepackage{tabularx}
\usepackage{booktabs}
\usepackage{float}
\usepackage[dvipdfmx]{xcolor}
\usepackage{listings} 

\title{データサイエンス レポート課題}
\author{25G1026　大菅　海兎}
\date{}

\lstset{
    language=Python,
    basicstyle=\ttfamily\small,
    frame={tb},
    breaklines=true,
    numbers=left,
    numberstyle=\color{gray},
    stepnumber=1,
    numbersep=5pt,
    tabsize=4,
    showspaces=false,
    xleftmargin=17pt,
    framexleftmargin=17pt,
    escapechar=@, 
}
\renewcommand{\lstlistingname}{ソースコード}

\begin{document}
\maketitle
\pagenumbering{gobble}

\subsection*{選択した分析手法}
{回帰分析}

\subsection*{例題}
2024年発売のPlayStation5用フルプライスタイトル(8000円から10000円)のMetacriticによる評価と，大手中古販売会社のオンラインショップ価格を100分の1にし，四捨五入してまとめた．
下記データについて中古販売価格と評価の回帰直線を求めよ．ただし，説明変数$x$を中古販売価格，目的変数$y$をMetaスコアとしなさい．

\vspace{1zh}
\begin{table}[H]\caption{中古価格と評価データ}
\centering
    \begin{tabular}{|c|c|c|c|c|c|c|c|c|}
        \hline
               & A & B & C & D & E & F & G & H \\ \hline
        販売価格 & 18 & 39 & 34 & 43 & 44 & 46 & 48 & 15 \\ \hline
        Metaスコア & 82 & 87 & 94 & 92 & 86 & 94 & 81 & 79 \\ \hline
    \end{tabular}
\end{table}

\subsection*{解答}
回帰分析は，最小二乗法から求められる標本回帰直線を利用する．この直線は，式\ref{regression_1}のように表される．
\begin{equation}
    \hat{y} = \hat{\beta_0} + \hat{\beta_1} x
    \label{regression_1}
\end{equation}

まずは，各変数の平均値を求める．$x$の平均値$\bar{x}$は式\ref{x_ave}のように求められる．
また，$y$の平均値$\bar{y}$は式\ref{y_ave}のように求められる．
\begin{equation}
    \bar{x} = \frac{1}{n} \sum_{i=1}^{n} x_i=\frac{287}{8}=35.875
    \label{x_ave}
\end{equation}

\begin{equation}
    \bar{y} = \frac{1}{n} \sum_{i=1}^{n} y_i=\frac{695}{8}=86.875
    \label{y_ave}
\end{equation}

次に，回帰係数$\hat{\beta_1}$を式\ref{beta_1}のように求める．
\begin{equation}
    \hat{\beta_1} = \frac{\sum_{i=1}^{n} (x_i - \bar{x})(y_i - \bar{y})}{\sum_{i=1}^{n} (x_i - \bar{x})^2} = \frac{268.8750}{1134.8750}=0.2369
    \label{beta_1}
\end{equation}

最後に，切片$\hat{\beta_0}$を式\ref{beta_0}のように求める．
\begin{equation}
    \hat{\beta_0} = \bar{y} - \hat{\beta_1} \bar{x} = 86.875 - 0.2369 \times 35.875 = 78.4064
    \label{beta_0}
\end{equation}

よって，求める標本回帰直線は式\ref{regression_2}のようになる．
\begin{equation}
    \hat{y} = 78.4064 + 0.2369 x
    \label{regression_2}
\end{equation}

式\ref{regression_2}から，中古販売価格が高いほどMetaスコアも高くなる傾向があるといえる．

\begin{figure}[H]
\centering
\begin{lstlisting}[caption=プログラム例, label=src, language=Python]
import numpy as np

# 1. データの準備
x = np.array([18, 39, 34, 43, 44, 46, 48, 15]) # 価格
y = np.array([82, 87, 94, 92, 86, 94, 81, 79]) # 評価

# 2. 基本統計量の計算
n = len(x)
x_mean = np.mean(x)
y_mean = np.mean(y)

# 3. 偏差、偏差の二乗、偏差の積の計算
x_diff = x - x_mean              # ｘの偏差 
y_diff = y - y_mean              # ｙの偏差
x_diff_sq = x_diff **2           # ｘの偏差平方
xy_diff = x_diff * y_diff        # 偏差の積

# 4. 合計値の計算
sum_x_diff_sq = np.sum(x_diff_sq) # ｘの偏差平方和 
sum_xy_diff = np.sum(xy_diff)     # 偏差共分散

# 5. 回帰係数の算出
beta_1_hat = sum_xy_diff / sum_x_diff_sq
beta_0_hat = y_mean - (beta_1_hat * x_mean)
y_hat = beta_1_hat * x + beta_0_hat

# 6. 結果の表示
print(f"価格の平均 (x_mean): {x_mean:.4f}")
print(f"評価の平均 (y_mean): {y_mean:.4f}")
print(f"傾き (beta_1_hat): {beta_1_hat:.4f}")
print(f"切片 (beta_0_hat): {beta_0_hat:.4f}")
print(f"最終的な回帰式: y_hat = {beta_0_hat:.4f} + {beta_1_hat:.4f} * x")
\end{lstlisting}
\end{figure}

\end{document}